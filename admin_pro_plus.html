<!DOCTYPE html>
<html lang="en">

	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>产品管理 - 铜呗后台管理系统</title>

		<meta name="description" content="overview &amp; stats" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<!-- bootstrap & fontawesome -->
		<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="assets/font-awesome/4.5.0/css/font-awesome.min.css" />

		<!-- page specific plugin styles -->
		
		<!--tree-->
		<link href="assets/tree/css/ligerui-tree.css" rel="stylesheet" type="text/css" />

		<!-- text fonts -->
		<link rel="stylesheet" href="assets/css/fonts.googleapis.com.css" />

		<!-- ace styles -->
		<link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

		<!--[if lte IE 9]>
			<link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
		<![endif]-->
		<link rel="stylesheet" href="assets/css/ace-skins.min.css" />
		<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />

		<!--[if lte IE 9]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->
		<script src="assets/js/ace-extra.min.js"></script>

		<!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

		<!--[if lte IE 8]>
		<script src="assets/js/html5shiv.min.js"></script>
		<script src="assets/js/respond.min.js"></script>
		<![endif]-->
		<link rel="stylesheet" href="assets/css/style.css"/>  
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets/css/ace.min.css" />
		<!--<link rel="stylesheet" href="Widget/zTree/css/zTreeStyle/zTreeStyle.css" type="text/css">
		<link rel="stylesheet" href="assets/css/font-awesome.min.css" />-->
		<!--[if IE 7]>
				  <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
				<![endif]-->
	<!--	<link href="Widget/icheck/icheck.css" rel="stylesheet" type="text/css" />-->
		<link href="assets/Widget/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
		<link rel="stylesheet" href="assets/css/self/buton.css" />
		<style type="text/css">
			 
			.clear
			{
			  clear:both;
			}
</style>
 
		
	</head>

	<body class="no-skin">
		<!--top part begin-->
        <div id="top"></div>
        <!--top part end-->

		<div class="main-container ace-save-state" id="main-container">

			<!--left tree begin-->
            <div id="leftTree" class="sidebar responsive ace-save-state"></div>
            <!--left tree end-->

			<div class="main-content">
			    <div class="widget-main padding-24">
                    <span style="font-size: 22px;"> 产品管理 </span>
                    <div class="hr hr8 hr-double hr-dotted"></div>
                    <div class="col-xs-12">
                        <button class="btn btn-danger" id="DelDetali"> 删除产品</button>
                    </div>
                    <div class="col-xs-12">
                        <div class="widget-box  widget-color-blue">
                            <div class="widget-header widget-header-flat">
                                <h4 class="widget-title smaller">产品类型列表</h4>
                                <h4 class="widget-title smaller" id="ProName"></h4>
                                <input type="text" id="proid" hidden="hidden">
                            </div>
                            <div class="tabbable ">
                                <ul class="nav nav-tabs padding-12">
                                    <!--<li class="active">
                                        <a data-toggle="tab" href="#home1">基本信息</a>
                                    </li>-->
                                    <li class="active">
                                        <a data-toggle="tab" href="#home2">产品介绍</a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#home3">产品轮播</a>
                                    </li>
                                </ul>
                                <div class="tab-content" >
                                    
                                    <div id="home2" class="tab-pane in active">
											<div class="clearfix" id="add_picture">
												<button class="btn btn-primary" id="SaveDetali">保存详情 </button>
												<form action="" method="post" class="form form-horizontal" id="form-article-add">
													<div class="widget-box">
														<div class="widget-header widget-header-flat">
							                                <h4 class="widget-title smaller">
							                                    <span>产品属性 </span>
	                                						</h4>
                           						 		</div>
													<!--<div class=" clearfix cl">-->
													
													<!--</div>-->
														<div class=" clearfix cl" style="margin-top: 20px;">
															<div class="Add_p_s">
													         	<label class="form-label col-2">产品名称：</label>
														     	<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="proname" name=""></div>
															</div>
															<!--<div class="Add_p_s">
												            <label class="form-label col-2">产品编号：</label>
															<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="pronum" name=""></div>
												            </div>
															<div class="Add_p_s">
												             <label class="form-label col-2">产&nbsp;&nbsp;&nbsp;&nbsp;地：</label>	
															 <div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="proplace" name=""></div>
															</div>
												            <div class="Add_p_s">
												             <label class="form-label col-2">材&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;质：</label>	
															 <div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="promateri" name=""></div>
															</div>
												            <div class="Add_p_s">
												             <label class="form-label col-2">品&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;牌：</label>	
															 <div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="probrand" name=""></div>
															</div>
												             <div class="Add_p_s">
												             <label class="form-label col-2">产品重量：</label>	
															 <div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="proweg" name="" >kg</div>
															</div>-->
												             <div class="Add_p_s">
													            <label class="form-label col-2">单&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;位：</label>	
																<div class="formControls col-2">
																 	<span class="select-box">
																	<select class="select" id="prounit">
																		<option>请选择</option>
																		<option value="件">件</option>
																		<option value="斤">斤</option>
																		<option value="KG">KG</option>
																		<option value="吨">吨</option>
																		<option value="套">套</option>
																	</select>
																	</span>
																</div>
															</div>
															<div class="Add_p_s">
													            <label class="form-label col-2">价&nbsp;&nbsp;&nbsp;&nbsp;格：</label>	
																<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="proprice" name="" >元</div>
															</div>
															</div>
														<div class=" clearfix cl">
												            
												            <!--<div class="Add_p_s">
												             <label class="form-label col-2">市场价格：</label>	
															 <div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="promarket" name="" >元</div>
															</div>-->
															<div class="Add_p_s">
																<label class="form-label col-2">产品状态：</label>
																<div class="formControls col-2">
																 	<select class="select" id="prosta">
																		<option value="显示">显示</option>
																		<option value="关闭">关闭</option>
																	</select>
														        </div>
													            </div>
												           <div class="Add_p_s">
																<label class="form-label col-2">热门状态：</label>
																<div class="formControls col-2">
																 	<select class="select" id="prohot">
																		<option value="是">是</option>
																		<option value="否">否</option>
																	</select>
														        </div>
												           </div>
												           <div class="Add_p_s">
														         	<label class="form-label col-2">积分倍数：</label>
															     	<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="exc" name=""></div>
															</div>
														</div>
														<div class="clearfix cl">
															<label class="form-label col-2">内容摘要：</label>
															<div class="formControls col-2">
																<input type="text" id="protext" class="textarea"  style="width: 1000px;">
																<!--<p class="textarea-numberbar"><em class="textarea-length">0</em>/200</p>-->
															</div>
														</div>
														<div class=" clearfix cl">
                                                            <label class="form-label col-2">产品图示：</label>
                                                            <div class="formControls col-10" style="border-color: black;">
                                                                <img id="prophoto" style="width: 320px;height: 300px;" />
                                                            </div>
                                                       </div>
												         <!--<div class="clearfix cl">
													        <label class="form-label col-2">详细内容：</label>
																<div class="formControls col-10">
																	<script id="editor" type="text/plain" style="width:100%;height:400px;"></script> 
																	<input id='content' type='hidden'/>
													            </div>
												        </div>-->
											      	</div>
												</form>
											</div>								
									</div>
									<!-- home2over-->
									<div id="home3" class="tab-pane">
                    						<div class="col-xs-5">
						                        <button class="btn btn-success" id="NewAds">新建节点</button>
						                        <button class="btn btn-danger" onclick="DelAds()">删除节点</button>
                    						</div>
						                    <div class="col-xs-7">
						                        <button class="btn btn-primary" href="#ads-mes" role="button" data-toggle="modal">修改节点属性</button>
						                    </div>
						    				<div class="col-xs-5">
						    				    <div class="widget-box">
						        					<div class="widget-header widget-header-flat">
						                                <h4 class="widget-title smaller">
						                                    <span>设置 </span>
                                						</h4>
                           						 	</div>
					        					<div class="widget-body">
					        					    <div class="widget-main">
					            						<table id="dynamic-table" class="table table-striped table-bordered table-hover" style="width:100%;height:100%;">
					            							<thead>
					            								<tr>
					            									<th>文字说明</th>
					            									<th>位置</th>
					            									<th>是否热门</th>
					            								</tr>
					            							</thead>
					            							<tbody></tbody>
					            						</table>
					        					   </div>
					        					</div>
					        			    </div>
					    				</div>
					    				<div class="col-xs-7">
					                        <div class="widget-box">
					                            <div class="widget-header widget-header-flat">
					                                <h4 class="widget-title smaller">
					                                    <span> 节点属性 </span>
					                                </h4>
					                                <input type="text" hidden="hidden" id="setid">
					                            </div>
					                            <div class="widget-body">
					                                <div class="widget-main">
					                                    <div class="tab-content" >
					                                        <img width="426px" height="200px" id="ImgSel"/>
					                                        <br /><br />
					                                        <div class="profile-user-info profile-user-info-striped"  >
					                                            <div class="profile-info-row" >
					                                            	<div class="profile-info-name">图片状态</div>
					                                            	<div class="profile-info-value">
															 		<select class="select" id="stament">
																		<option value="显示">显示</option>
																		<option value="关闭">关闭</option>
																	</select>
																	<button id="savestament">保存</button>
													        		</div>
					                                            </div>
					                                        </div>
					                                        <div class="profile-user-info profile-user-info-striped">
					                                            <div class="profile-info-row">
					                                                <div class="profile-info-name"> 图片说明 </div>
					                                                <div class="profile-info-value">
					                                                    <span class="editable" id="ImgElse">  </span>
					                                                </div>
					                                            </div>
					                                        </div>
					                                    </div>
					                                </div>
					                            </div>
					                        </div>
					                   </div>
									</div>
									<div class="clear"></div>
									<!--  home3over-->
								</div>
								 <!--tab-contentover-->
							</div>
							<!--tabbleover-->
						</div>
						<!--widegetboxover-->
						<div class="space-6"></div>
					</div>
					<!--12over-->
				</div><!--paddover-->
			</div><!--maincontent-->
			<div id="model-ads"></div>									
			<!--footer part begin-->
			<div id="footer" class="footer"></div>
			<!--footer part end-->
											
		</div><!--main-container-->
													
		<script src="assets/js/jquery-2.1.4.min.js"></script>
		<!--ace-->
		<script src="assets/js/ace-elements.min.js"></script>
		<script src="assets/js/ace.min.js"></script>
		<!--newworld-->
		<script type="text/javascript" src="assets/Widget/My97DatePicker/WdatePicker.js"></script>
		<script type="text/javascript" src="assets/Widget/icheck/jquery.icheck.min.js"></script>
		<script type="text/javascript" src="assets/Widget/zTree/js/jquery.ztree.all-3.5.min.js"></script>
		<script type="text/javascript" src="assets/Widget/Validform/5.3.2/Validform.min.js"></script>
		<script type="text/javascript" src="assets/Widget/webuploader/0.1.5/webuploader.min.js"></script>
		<!--<script type="text/javascript" src="assets/Widget/ueditor/1.4.3/ueditor.config.js"></script>
		<script type="text/javascript" src="assets/Widget/ueditor/1.4.3/ueditor.all.min.js"></script>-->
		<!--<script type="text/javascript" src="assets/Widget/ueditor/1.4.3/lang/zh-cn/zh-cn.js"></script>-->
		<!--<script src="js/jquery-1.9.1.min.js"></script>-->
		<script src="assets/js/bootstrap.min.js"></script>
		
		<!--datatable-->
		<script src="assets/js/jquery.dataTables.min.js"></script>
		<script src="assets/js/jquery.dataTables.bootstrap.min.js"></script>
		<script src="assets/js/dataTables.buttons.min.js"></script>
		<script src="assets/js/dataTables.select.min.js"></script>
		<!--self-->
	    <script src="assets/js/self/Actionproplus.js"></script>
		<!--<script type="text/javascript">
//			实例化
	        var editor = UE.getEditor('editor');
	    </script>-->
		<script type="text/javascript">
    		/* * INI Page */
    		$("#top").load("pageTop.html")
    		$("#leftTree").load("pageLeft.html")
    		$("#footer").load("pageFoot.html")
    		
    		$('#model-ads').load('model_plus.html')
    		
    		/*textarea 字数限制*/
//			function textarealength(obj,maxlength){
//				var v = $(obj).val();
//				var l = v.length;
//				if( l > maxlength){
//					v = v.substring(0,maxlength);
//				}
//				$(obj).parent().find(".textarea-length").text(v.length);
//			}
//			
    		jQuery(function($) { 
    			
    			var loc=location.href;
    			var n1=loc.length;//地址的总长度
    			var n2=loc.indexOf("=");//取得=号的位置
    			var id=decodeURI(loc.substr(n2+1, n1-n2));//从=号后面的内容
    //			alert(id);
                var proid=document.getElementById("proid").value;
                proid=id;
//              alert(proid)
                /*
				 * INI DataTable
				 */
				tabMesSimple = $('#dynamic-table').DataTable({
	                ajax:'php/TableShowProplus.php?id='+id,
	                columns:[
	                    {"data":'else'},
	                    {"data":'place'},
	                    {"data":'status'},
	                ],
					oLanguage: {
						sLengthMenu: "显示 _MENU_ 条数据",
					},
					"processing": true,
					"aaSorting": [],
					"aoColumnDefs": [{
						'bSortable': false,
						'aTargets': [0]
					}],
				});
//				 
    //          显示数据
                $.ajax({
                	type:"post",
                	url:"php/Proplus.php",
                	async:true,
                	dataType:'json',
                	data:{
                		falg:'show',
                	    id:proid,
                	},
                	success:function(data){
//              	    console.log(data)
                	    $("#proname").val(data.proname);
                	   	$("#prounit").val(data.prounit);
                	    $("#proprice").val(data.proprice);
                	    $('#protext').val(data.protext);
                	    $('#prosta').val(data.prosta);
                	    $('#prohot').val(data.prohot);
                	    $('#exc').val(data.exc);
//              	    $('#content').val(data.procontent);//详情
                	    $('#prophoto').attr('src',data.prophoto)
                	},
                	error:function(s,e,t){
                		alert('出现错误，请联系管理员')
            		}
                	});
                	//保存详情
               
    		 	$('#SaveDetali').on('click',function(){
//  		 		var pcontent = UE.getEditor('editor').getContent();
    		 		var text =$("#protext").val();
    		 		fData = new FormData();
    		 		fData.append("falg","save");
    		 		fData.append("id",proid);
    			    fData.append("pname",$("#proname").val());
    		 		fData.append('punit',$("#prounit").val());
    		 		fData.append('pprice',$("#proprice").val());
    		 		fData.append('phot',$("#prohot").val());
    		 		fData.append('psta',$("#prosta").val());
    		 		fData.append('exc',$("#exc").val());
    		 		fData.append('ptext',text);
//  		 		fData.append('pcontent',pcontent);
    		 		$.ajax({
    		 			type:"post",
    		 			url:"php/Proplus.php",
    		 			async:true,
    		 			dataType:'json',
    		 			data:fData,
    		 			processData:false,
        				contentType:false,
    		 			success:function(data){
    		 				if(data['status'] == 'success'){
                				alert('保存成功')
            				}
    		 			},
            			error:function(s,e,t){
    				        alert('出现错误，请及时联系管理员');
    					}
    		 		});
    		 	});
    		 	
    		})
    		//ACTION	
            $('#dynamic-table tbody').on('click', 'tr', function () {
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                }
                else {
                    tabMesSimple.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                }
                try{
                   $('#setid').attr('value',tabMesSimple.row('.selected').data().id)
                    //右边信息框
                    $('#MesId').attr('value',tabMesSimple.row('.selected').data().id)
                    $('#ImgSel').attr('src',tabMesSimple.row('.selected').data().url)
                    $('#ImgElse').text(tabMesSimple.row('.selected').data().else)
                    $('#stament').val(tabMesSimple.row('.selected').data().stament)
                    
                    //模态框信息显示
                        //清空
                    $("#adsMes").val('')
                    $('#AdsImg').val('')
                    $('#ImgShow').attr('src','')
                    $('#AdsStaOp').text('')
                        //显示
                    $('#adsMes').val(tabMesSimple.row('.selected').data().else)
                    $('#AdsStaOp').text(tabMesSimple.row('.selected').data().status)
                    $('#ImgShow').attr('src',tabMesSimple.row('.selected').data().url)
                    
                }
                catch(e){
                    console.log(e)
                }
            })
            //新建广告节点
            $('#NewAds').on('click',function(){
//              	alert("hello")
                //清空模态框中的数据
                $('#MesId').val('')
                $("#adsMes").val('')
                $('#AdsImg').val('')
                $('#ImgShow').attr('src','')
                $('#AdsStaOp').text('')
//                  //显示模态框
                $('#ads-mes').modal('show')
            })
            $('#savestament').on('click',function(){
		 		$.ajax({
		 			type:"post",
		 			url:"php/plus.php",
		 			async:true,
		 			dataType:'json',
		 			data:{
		 				flag:'savesta',
		 				id:$('#setid').val(),
						psta:$('#stament').val(),
		 			},
		 			success:function(data){
		 			 if(data['status'] == 'success')
		 			 {
		 				alert('保存成功')
		 				$("#setid").load(location.href+" #setid");
		 				tabMesSimple.ajax.reload();
		 				}
		 			},
		 			error:function(s,e,t){
		        	    alert('失败，请及时联系管理员')
		        	}
		 		});
		 	})
			//ue实例化之后
//			editor.ready(function()
//			{
//			    editor.setContent($("#content").val());
//			});
		
			
		</script>
	</body>

</html>