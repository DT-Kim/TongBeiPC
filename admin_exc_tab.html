<!DOCTYPE html>
<html lang="en">

	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>积分商品 - 铜呗后台管理系统</title>

		<meta name="description" content="overview &amp; stats" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<!-- bootstrap & fontawesome -->
		<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="assets/font-awesome/4.5.0/css/font-awesome.min.css" />

		<!-- page specific plugin styles -->
		
		<!--tree-->
		<link href="assets/tree/css/ligerui-tree.css" rel="stylesheet" type="text/css" />

		<!-- text fonts -->
		<link rel="stylesheet" href="assets/css/fonts.googleapis.com.css" />

		<!-- ace styles -->
		<link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

		<!--[if lte IE 9]>
			<link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
		<![endif]-->
		<link rel="stylesheet" href="assets/css/ace-skins.min.css" />
		<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />

		<!--[if lte IE 9]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->
		<script src="assets/js/ace-extra.min.js"></script>

		<!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

		<!--[if lte IE 8]>
		<script src="assets/js/html5shiv.min.js"></script>
		<script src="assets/js/respond.min.js"></script>
		<![endif]-->
		<!--产品介绍-->
		<link rel="stylesheet" href="assets/css/style.css"/>  
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets/css/ace.min.css" />
		<link href="assets/Widget/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			.editable
			{
				border: 1px solid #FFFFFF;
			}
		</style>
	</head>

	<body class="no-skin">
		<!--top part begin-->
        <div id="top"></div>
        <!--top part end-->

		<div class="main-container ace-save-state" id="main-container">

			<!--left tree begin-->
            <div id="leftTree" class="sidebar responsive ace-save-state"></div>
            <!--left tree end-->

			<div class="main-content">
				<div class="widget-main padding-24">
			    	<span style="font-size: 22px;"> 积分管理</span>
                    <div class="hr hr8 hr-double hr-dotted"></div>
                    <div class="col-xs-5">
                        <button class="btn btn-success" id="NewExc">增加商品</button>
                        <button class="btn btn-danger" onclick="DelExc()">删除商品</button>
                        <button class="btn btn-primary"  href="#Exc-add" role="button"  data-toggle="modal">编辑商品</button>
                    </div>
                    <div class="col-xs-7">
                        <button class="btn btn-primary" id="SaveDetali"> 保存详情 </button>
                    </div>
                    <div class="col-xs-5">
                        <div class="widget-box">
                            <div class="widget-header widget-header-flat">
                                <h4 class="widget-title smaller">积分详情</h4>
                                <h4 class="widget-title smaller" id="ProName"></h4>
                            </div>
                            <div class="tabbable">
                                <ul class="nav nav-tabs padding-12">
                                    <li class="active">
                                        <a data-toggle="tab" href="#">积分详细 </a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div id="home1" class="tab-pane in active">
                                        <table id="dynamic-table-exc" class="table table-striped table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    <th>商品名称</th>
                                                    <th>积分要求</th>
                                                    <th>商品描述</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>普通客户</td>
                                                    <td>娜娜</td>
                                                    <td>200 </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="home2" class="tab-pane">

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="space-6"></div>
                    </div>
                <div class="col-xs-7">
                    <div class="widget-box">
                        <div class="widget-header widget-header-flat">
                            <h4 class="widget-title smaller">详细信息</h4>
                            <h4 class="widget-title smaller" id="ProName"></h4>
                            <input type="text" id="goodid" hidden="hidden">
                        </div>
                        <div class="tabbable">
                            <ul class="nav nav-tabs padding-12">
                                <!--<li class="active">
                                    <a data-toggle="tab" href="#menu">基本信息</a>
                                </li>-->
                                <li class="active">
                                    <a data-toggle="tab" href="#menu1">商品介绍</a>
                                </li>
                                
                            </ul>
                           <!-- menu部分-->
                            <div class="tab-content">
                                <!--<div id="menu" class="tab-pane in active">
                                   <div class="profile-user-info profile-user-info-striped">
                                        
                                        <div class="profile-info-row">
                                            <div class="profile-info-name"> 商品名称 </div>
                                            <div class="profile-info-value">
                                                <input class="editable" id="" onfocus=this.blur() >
                                            </div>
                                        </div>
                                        
                                        <div class="profile-info-row">
                                            <div class="profile-info-name"> 商品</div>
                                            <div class="profile-info-value">
                                                <input class="editable" id="" onfocus=this.blur()>
                                            </div>
                                        </div>
                                        <div class="profile-info-row">
                                            <div class="profile-info-name">商品</div>
                                            <div class="profile-info-value">
                                                <input id="" class="editable" onfocus=this.blur()>
                                            </div>
                                         </div>
                                        <div class="profile-info-row">
                                        	
                                            <div class="profile-info-name">商品 </div>
                                            <div class="profile-info-value">
                                                <input class="editable" id="" onfocus=this.blur()>
                                            </div>
                                        </div>
                                        
                                        <div class="profile-info-row">
                                            <div class="profile-info-name">商品</div>
                                            <div class="profile-info-value">
                                                <input class="editable" id="" onfocus=this.blur()> 
                                            </div>
                                        </div>
                                </div>
                               </div>-->
                               <!-- menu1部分-->
                                <div id="menu1" class="tab-pane in active">
									<div class="clearfix" id="add_picture">
										<form action="" method="post" class="form form-horizontal" id="form-article-add">
										<div class=" clearfix cl">
											<div class="Add_p_s">
									            <label class="form-label col-2">商品名称：</label>
										     	<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="proname" name=""></div>
										    </div>
								            <div class="Add_p_s">
								            	<label class="form-label col-2">单&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;位：</label>	
												<div class="formControls col-2">
													<span class="select-box">
														<select class="select" id="prounit">
															<option>请选择</option>
															<option value="件">件</option>
															<option value="斤">斤</option>
															<option value="KG">KG</option>
															<option value="吨">吨</option>
															<option value="套">套</option>
													    </select>
													</span>
												</div>
											</div>	
										</div>
										<div class=" clearfix cl">
											<div class="Add_p_s">
												<label class="form-label col-2">商品状态：</label>
												<div class="formControls col-2">
												 	<select class="select" id="prosta">
														<option>请选择</option>
														<option value="显示">显示</option>
														<option value="关闭">关闭</option>
													</select>
										        </div>
									        </div>
								            <div class="Add_p_s">
												<label class="form-label col-2">热门状态：</label>
												<div class="formControls col-2">
												 	<select class="select" id="prohot">
														<option>请选择</option>
														<option value="是">是</option>
														<option value="否">否</option>
													</select>
										        </div>
								            </div>
								           <div class="Add_p_s">
									         	<label class="form-label col-2">所需积分：</label>
										     	<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="exc" name=""></div>
											</div>
											<!--<div class="Add_p_s">
								             <label class="form-label col-2">价&nbsp;&nbsp;&nbsp;&nbsp;格：</label>	
											 <div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="proprice" name="" >元</div>
											</div>-->
											
										</div>
											
										<div class="clearfix cl">
											<label class="form-label col-2">内容摘要：</label>
											<div class="formControls col-10">
												<textarea name="" cols="" rows="" id="protext" class="textarea"  placeholder="说点什么...最少输入10个字符" datatype="*10-100" dragonfly="true" nullmsg="备注不能为空！" onKeyUp="textarealength(this,200)"></textarea>
												<p class="textarea-numberbar"><em class="textarea-length">0</em>/200</p>
											</div>
										</div>
											
								        <div class="clearfix cl">
								        <label class="form-label col-2">详细内容：</label>
											<div class="formControls col-10">
												<script id="editor" type="text/plain" style="width:100%;height:400px;"></script> 
												<input id='content' type='hidden'/>
								             </div>
									   </div>
										</form>
								    </div>		
                                </div>
                                <!--menu1结束  -->
                            </div><!--table结束-->
                        </div>
                    </div>
                    <div class="space-6"></div>
                </div>
			</div>
	   	</div>
        <!--page model begin-->
		<div id="model-exc"></div>
		<!--page model end-->
		
		<!--footer part begin-->
        <div id="footer" class="footer"></div>
        <!--footer part end-->

		</div>
         <!--self-->
		<script src="assets/js/self/ActionExc.js"></script>
		<script src="assets/js/jquery-2.1.4.min.js"></script>
		<script src="assets/js/bootstrap.min.js"></script>
		<!--dataTable-->
        <script src="assets/js/jquery.dataTables.min.js"></script>
        <script src="assets/js/jquery.dataTables.bootstrap.min.js"></script>
        <script src="assets/js/dataTables.buttons.min.js"></script>
        <script src="assets/js/dataTables.select.min.js"></script>
		<!--ace-->
		<script src="assets/js/ace-elements.min.js"></script>
		<script src="assets/js/ace.min.js"></script>
		<script type="text/javascript" src="assets/Widget/ueditor/1.4.3/ueditor.config.js"></script>
		<script type="text/javascript" src="assets/Widget/ueditor/1.4.3/ueditor.all.min.js"></script>
		<script src="assets/js/self/ActionExc.js"></script>
		<script type="text/javascript">
//			实例化
	        var editor = UE.getEditor('editor');
	    </script>
		
		<script type="text/javascript">
			/*
			 * INI Page
			 */
		    $("#top").load("pageTop.html")
            $("#leftTree").load("pageLeft.html")
            $("#footer").load("pageFoot.html")
            $('#model-exc').load('model_exc.html')
            /*textarea 字数限制*/
			function textarealength(obj,maxlength){
				var v = $(obj).val();
				var l = v.length;
				if( l > maxlength){
					v = v.substring(0,maxlength);
				}
				$(obj).parent().find(".textarea-length").text(v.length);
			}
            
			jQuery(function($) {
				 //show detali
//              $('#showDetali').on('click',function(){
//                  self.location='admin_pro_plus.html'
//              })
                //查询
                $('#chaxun').on('click',function(){
//              	self.location='query_use_tab.html'
                })
			    /*
			     * INI DataTable
			     */
			    tabMesType = $('#dynamic-table-exc').DataTable({
                    ajax:'php/TableShowExc.php?falg=exc',
                    columns:[
                        {"data":'excName'},
                        {"data":'excreq'},
                        {"data":'excElse'},
                    ],
                    oLanguage: {
                        sLengthMenu: "显示 _MENU_ 条数据",
                    },
                    "processing": true,
                    "aaSorting": [],
                    "aoColumnDefs": [{
                        'bSortable': false,
                        'aTargets': []
                    }],
                });
                 tabMesList = $('#dynamic-table-list').DataTable({
//                  ajax:showMes,
//                  columns:[
//                      {"data":'formName'},
//                      {"data":'uploadTime'},
//                      {"data":'page'},
//                      {"data":'page'},
//                  ],
                    oLanguage: {
                        sLengthMenu: "显示 _MENU_ 条数据",
                    },
                    "processing": true,
                    "aaSorting": [],
                    "aoColumnDefs": [{
                        'bSortable': false,
                        'aTargets': [0]
                    }],
                });
//              保存
                $('#SaveDetali').on('click',function(){
    		 		var pcontent = UE.getEditor('editor').getContent();
    		 		var text =$("#protext").val();
    		 		fData = new FormData();
    		 		fData.append("falg","save");
    		 		fData.append("id",$("#goodid").val());
    			    fData.append("pname",$("#proname").val());
    		 		fData.append('punit',$("#prounit").val());
//  		 		fData.append('pprice',$("#proprice").val());
    		 		fData.append('phot',$("#prohot").val());
    		 		fData.append('psta',$("#prosta").val());
    		 		fData.append('exc',$("#exc").val());
    		 		fData.append('ptext',text);
    		 		fData.append('pcontent',pcontent);
    		 		$.ajax({
    		 			type:"post",
    		 			url:"php/Exc.php",
    		 			async:true,
    		 			dataType:'json',
    		 			data:fData,
    		 			processData:false,
        				contentType:false,
    		 			success:function(data){
    		 				
    		 				if(data['status'] == 'success'){
                				alert('保存成功');
                				window.location.reload();
            				}
    		 			},
            			error:function(s,e,t){
    				        alert('出现错误，请及时联系管理员');
    					}
    		 		});
    		 	});
    		 	
    		 	
             //action
                $('#dynamic-table-exc tbody').on('click', 'tr', function () {
                    if ($(this).hasClass('selected')) {
                        $(this).removeClass('selected');
                    }
                    else {
                        tabMesType.$('tr.selected').removeClass('selected');
                        $(this).addClass('selected');
                    }
                    try{
//                      $('#ExcId').attr('value',tabMesType.row('.selected').data().id)
//                      $('#ProExcName').attr('value',tabMesType.row('.selected').data().excName)
//                      $('#ExcReq').attr('value',tabMesType.row('.selected').data().excreq)
						$('#ExcId').val(tabMesType.row('.selected').data().id)
                        $('#ProExcName').val(tabMesType.row('.selected').data().excName)
                        $('#ExcReq').val(tabMesType.row('.selected').data().excreq)
                        $('#ProExcElse').text(tabMesType.row('.selected').data().excElse)
                        
                        
                        $('#goodid').val(tabMesType.row('.selected').data().id)
                        $("#proname").val(tabMesType.row('.selected').data().excName);
                	   	$("#prounit").val(tabMesType.row('.selected').data().excunit);
//              	    $("#proprice").val(tabMesType.row('.selected').data().id);
                	    $('#protext').val(tabMesType.row('.selected').data().excElse);
                	    $('#prosta').val(tabMesType.row('.selected').data().excsta);
                	    $('#prohot').val(tabMesType.row('.selected').data().exchot);
                	    $('#exc').val(tabMesType.row('.selected').data().excreq);
                	    $('#content').val(tabMesType.row('.selected').data().exctext);
                	    //ue实例化之后
						editor.ready(function()
						{
						    editor.setContent($("#content").val());
						})
                    }catch(e){
                        
                    }
                })
                $('#dynamic-table-list tbody').on('click', 'tr', function () {
                    if ($(this).hasClass('selected')) {
                        $(this).removeClass('selected');
                    }
                    else {
                        tabMesList.$('tr.selected').removeClass('selected');
                        $(this).addClass('selected');
                    }
                    try{
                        alert('click')
                    }catch(e){ }
                })
           
                /*
                 * function
                 */
                $('#NewExc').on('click',function(){
                	$('#ExcId').val('')
	                $('#ProExcName').val('')
	                $('#ExcReq').val('')
	                $('#ProExcElse').val('')
	                $('#Exc-add').modal('show')
	                //直接显示
                })
			})
			
			//左边树添加active
                setTimeout(function(){
                	SetTreeActive(3);
                },1)
		 </script>
		<script type="text/javascript">
			
		</script>
	
	</body>

</html>