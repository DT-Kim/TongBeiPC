<!--ads begin-->
<div id="ads-mes" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header no-padding">
                <div class="table-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <span class="white">&times;</span>
                    </button>
                    <span>产品轮播</span>
                    <input id="MesId" hidden="hidden" />
                </div>
            </div>
            <div class="modal-body no-padding">
                <div class="form-group has-info  page-header">
                    <label class="col-sm-3 control-label no-padding-right"> 文字说明：</label>
                    <div class="col-sm-5">
                        <span class="block input-icon input-icon-right">
                            <input class="NewDocMes" type="text" id="adsMes" />
                        </span>
                    </div>
                    <div class="help-block col-xs-12 col-sm-reset inline"> </div>
                </div>
                <div class="form-group has-info page-header" style="height: 50px;">
                    <label class="col-sm-3 control-label no-padding-right"> 图片状态：</label>
                    <div class="col-sm-5">
                        <span class="block input-icon input-icon-right">
                            <select id="AdsSta">
                                <option id="AdsStaOp"></option>
                                <option>显示</option>
                                <option>隐藏</option>
                            </select>
                        </span>
                    </div>
                    <div class="help-block col-xs-12 col-sm-reset inline"> </div>
                </div>
                
                <div class="form-group has-info page-header" style="height: 50px;">
                    <label class="col-sm-3 control-label no-padding-right"> 产品图：</label>
                    <div class="col-sm-5">
                        <span class="block input-icon input-icon-right">
                            <input type="file" id="AdsImg"/>
                        </span>
                    </div>
                    <div class="help-block col-xs-12 col-sm-reset inline"> </div>
                </div>
                
                <div class="form-group has-info page-header" style="height: 250px;">
                    <label class="col-sm-3 control-label no-padding-right"> 成功预览：</label>
                    <div class="col-sm-5">
                        <span class="block input-icon input-icon-right">
                            <img width="416px" height="200px" id="ImgShow" />
                        </span>
                    </div>
                    <div class="help-block col-xs-12 col-sm-reset inline"> </div>
                </div>

            </div>
            <br /><br />
            <div class="modal-footer no-margin-top">
                <button class="btn btn-sm btn-success pull-right" data-dismiss="" id="ProMesSave">
                    <i class="ace-icon fa fa-floppy-o bigger-125"></i>
                    <span>保存</span>
                </button>
                <button class="btn btn-sm btn-danger pull-left" data-dismiss="modal">
                    <i class="ace-icon fa fa-times"></i>
                    <span>关闭</span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--ads end-->
<!--ads begin-->
<div id="ads_mes_2" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header no-padding">
                <div class="table-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <span class="white">&times;</span>
                    </button>
                    <span>位置设置</span>
                    <input id="MesId" hidden="hidden" />
                </div>
            </div>
            <div class="modal-body no-padding" id="addressinfo">
            	
                <!--<div class="form-group has-info page-header" style="height: 50px;">
                    <label class="col-sm-3 control-label no-padding-right"> 位置1：</label>
                    <div class="col-sm-5">
                        <span class="block input-icon input-icon-right">
                            <select class="select form-control">
                                <option selected="selected" value="38">7777</option>
                                <option value="39">77777</option>
                                <option value="40">1111</option>
                            </select>
                        </span>
                    </div>
                    <div class="help-block col-xs-12 col-sm-reset inline"> </div>
                </div>-->
                
            </div>
            <br /><br />
            <div class="modal-footer no-margin-top">
                <button class="btn btn-sm btn-success pull-right" data-dismiss="" id="savesetaddress">
                    <i class="ace-icon fa fa-floppy-o bigger-125"></i>
                    <span>保存</span>
                </button>
                <button class="btn btn-sm btn-danger pull-left" data-dismiss="modal">
                    <i class="ace-icon fa fa-times"></i>
                    <span>关闭</span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--ads end-->
<script type="text/javascript">
$('#ProMesSave').on('click',function(){
    //修改
    if (($('#MesId').val()).length) {
    	EditAds()
    }
    //新建
    else{
        AddAds()
    }
    $('#ads-mes').modal('hide')
})
//保存设置位置
$("#savesetaddress").on('click',function(){
	var repeatflag = "success";//用于检测是否重复的图片位置一样
	var send_data = {
		"flag" : "SaveSetAddress",
		"sdata" : new Array()
	};
	$("#addressinfo select").each(function(){
		console.log(send_data.sdata.indexOf($(this).val()));
		if(send_data.sdata.indexOf($(this).val()) >= 0){
			repeatflag = "default";
		}else{
			send_data.sdata.push($(this).val());
		}
	});
	if(repeatflag == "success"){
		$.ajax({
			type:"POST",
			url:"php/plus.php",
			data:send_data,
			dataType:"json",
			success:function(data){
				console.log(data);
				if(data.state == "success"){
					alert("设置成功");
					location.reload();
				}else{
					alert("设置失败");
					console.log(data.message);
				}
			},
			error:function(x,s,t){
				console.log(s+": "+t);
			}
		});
	}else{
		alert("有图片位置重复，请更正再保存");
	}
});
$('#AdsImg').on('change',function(){
	  var objUrl = getObjectURL(this.files[0]) ;
    	if(objUrl){
    		alert('已上传')
    	}
    	$("#ImgShow").attr("src", objUrl) ;
})
//建立一個可存取到該file的url
function getObjectURL(file) {
  var url = null ; 
  // 下面函数执行的效果是一样的，只是需要针对不同的浏览器执行不同的 js 函数而已
  if (window.createObjectURL!=undefined) { // basic
    url = window.createObjectURL(file) ;
  } 
  else if (window.URL!=undefined) { // mozilla(firefox)
    url = window.URL.createObjectURL(file) ;
  } 
  else if (window.webkitURL!=undefined) { // webkit or chrome
    url = window.webkitURL.createObjectURL(file) ;
  }
//alert(url)
  return url ;
}
</script>